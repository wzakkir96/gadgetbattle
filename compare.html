<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Compare Phones - GadgetBattle</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    .comparison-table td, .comparison-table th {
      vertical-align: middle;
      text-align: center;
    }
  </style>
</head>
<body>

  <!-- Header -->
  <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
    <div class="container-fluid">
      <a class="navbar-brand" href="index.html">GadgetBattle</a>
    </div>
  </nav>

  <!-- Main Content -->
  <div class="container my-4">
    <h2 class="text-center">Compare Phones</h2>

    <!-- Select Phones -->
    <div class="row mb-4">
      <div class="col-md-5">
        <select id="phone1" class="form-select"></select>
      </div>
      <div class="col-md-2 text-center align-self-center">vs</div>
      <div class="col-md-5">
        <select id="phone2" class="form-select"></select>
      </div>
    </div>

    <!-- Comparison Table -->
    <div id="comparison" class="table-responsive"></div>
  </div>

  <script>
    const phonesUrl = 'phones.json'; // make sure this file exists in your root
    let phones = [];

    async function loadPhones() {
      const res = await fetch(phonesUrl);
      phones = await res.json();
      const select1 = document.getElementById('phone1');
      const select2 = document.getElementById('phone2');
      phones.forEach(phone => {
        const option1 = new Option(phone.name, phone.model);
        const option2 = new Option(phone.name, phone.model);
        select1.add(option1);
        select2.add(option2);
      });
    }

    function getPhoneByModel(model) {
      return phones.find(p => p.model === model);
    }

    function renderComparison() {
      const p1 = getPhoneByModel(document.getElementById('phone1').value);
      const p2 = getPhoneByModel(document.getElementById('phone2').value);
      if (!p1 || !p2) return;

      const batteryDiff = p1.battery - p2.battery;
      const ramDiff = p1.ram - p2.ram;
      const batteryNote = batteryDiff > 0 ? `${p1.name} has ${batteryDiff}mAh more battery.` : `${p2.name} has ${-batteryDiff}mAh more battery.`;
      const ramNote = ramDiff > 0 ? `${p1.name} has ${ramDiff}GB more RAM.` : `${p2.name} has ${-ramDiff}GB more RAM.`;

      document.getElementById('comparison').innerHTML = `
        <table class="table table-bordered comparison-table">
          <thead>
            <tr>
              <th>Feature</th>
              <th>${p1.name}</th>
              <th>${p2.name}</th>
            </tr>
          </thead>
          <tbody>
            <tr><td>Chipset</td><td>${p1.chipset}</td><td>${p2.chipset}</td></tr>
            <tr><td>Battery (mAh)</td><td>${p1.battery}</td><td>${p2.battery}</td></tr>
            <tr><td>RAM (GB)</td><td>${p1.ram}</td><td>${p2.ram}</td></tr>
            <tr><td>Refresh Rate (Hz)</td><td>${p1.refreshRate}</td><td>${p2.refreshRate}</td></tr>
            <tr><td><strong>Insights</strong></td><td colspan="2">${batteryNote}<br>${ramNote}</td></tr>
          </tbody>
        </table>
      `;
    }

    document.addEventListener('DOMContentLoaded', async () => {
      await loadPhones();
      document.getElementById('phone1').addEventListener('change', renderComparison);
      document.getElementById('phone2').addEventListener('change', renderComparison);
    });
  </script>

</body>
</html>
